<div class="impersonator_settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b>Impersonator</b>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
            <label class="flex-container">
                <input type="checkbox" id="impersonator_enabled"><span>Enable Impersonator</span>
            </label>

            <hr>

            <div class="impersonator-preset">
                <strong for="impersonator-preset-actions" data-i18n="Impersonator Preset">
                    Impersonator Preset:
                </strong>
                <div class="impersonator-preset-actions">
                    <select id="impersonator-preset-list" class="text_pole"></select>
                    <div class="impersonator-preset-add menu_button menu_button_icon fa-solid fa-plus" id="impersonator-preset-new" title="Create new preset"></div>
                    <div class="impersonator-preset-add menu_button menu_button_icon fa-solid fa-file-import" id="impersonator-preset-import" title="Import preset"></div>
                    <input type="file" id="impersonator-preset-importFile" accept=".json" hidden>
                    <div class="impersonator-preset-add menu_button menu_button_icon fa-solid fa-file-export" id="impersonator-preset-export" title="Export preset"></div>
                    <div class="impersonator-preset-del menu_button menu_button_icon fa-solid fa-trash redWarningBG" id="impersonator-preset-delete" title="Delete preset"></div>
                </div>
            </div>

            <hr>

            <div id="impersonator_config" class="imp--config">
                <div class="flex-container flexFlowColumn">
                    
                    <div class="marginTop10">
                        <label for="impersonator_pov">
                            <strong>Point of View</strong>
                            <small>(Controls {{pov}} in prompt)</small>
                        </label>
                        <select id="impersonator_pov" class="text_pole">
                            <option value="first">First Person (I, me, my)</option>
                            <option value="second">Second Person (You, your)</option>
                            <option value="third">Third Person ({{user}}, they)</option>
                        </select>
                    </div>

                    <div class="marginTop10">
                        <label for="impersonator_response_style">
                            <strong>Response Length</strong>
                            <small>(Controls {{length}} in prompt)</small>
                        </label>
                        <select id="impersonator_response_style" class="text_pole">
                            <option value="short">Short (1-3 sentences)</option>
                            <option value="medium">Medium (2-4 paragraphs)</option>
                            <option value="long">Long (4+ paragraphs, detailed)</option>
                            <option value="adaptive">Adaptive (match previous style)</option>
                        </select>
                    </div>

                    <hr>

                    <label for="impersonator_system_prompt">
                        <strong>System Prompt</strong>
                        <small>(Use {{pov}} and {{length}} as variables)</small>
                    </label>
                    <textarea id="impersonator_system_prompt" class="text_pole textarea_compact" rows="12" placeholder="You are {{user}}..."></textarea>

                    <div class="marginTop10">
                        <label for="impersonator_context_size">
                            <strong>Context Messages</strong>
                            <small>(Number of recent messages to include)</small>
                        </label>
                        <div class="flex-container alignItemsCenter">
                            <input id="impersonator_context_size" type="range" min="5" max="30" step="1" value="15" class="flex1">
                            <span id="impersonator_context_size_value" class="range-block-counter">15</span>
                        </div>
                    </div>

                    <div class="marginTop10">
                        <label for="impersonator_max_tokens">
                            <strong>Max Response Length</strong>
                            <small>(0 = use default)</small>
                        </label>
                        <div class="flex-container alignItemsCenter">
                            <input id="impersonator_max_tokens" type="range" min="0" max="1000" step="50" value="300" class="flex1">
                            <span id="impersonator_max_tokens_value" class="range-block-counter">300</span>
                        </div>
                    </div>

                    <hr>

                    <div>
                        <strong>Context Options</strong>
                    </div>

                    <div class="marginTop10">
                        <label class="checkbox_label" for="impersonator_include_persona">
                            <input id="impersonator_include_persona" type="checkbox" class="checkbox" checked>
                            <span>Include User Persona (Recommended)</span>
                        </label>
                    </div>

                    <div class="marginTop10">
                        <label class="checkbox_label" for="impersonator_include_char_card">
                            <input id="impersonator_include_char_card" type="checkbox" class="checkbox">
                            <span>Include Character Card</span>
                        </label>
                    </div>

                    <hr>

                    <div class="flex-container flexGap5">
                        <button id="impersonator_test" class="menu_button flex1" title="Test the impersonation with current settings">
                            <i class="fa-solid fa-flask"></i>
                            <span>Test</span>
                        </button>
                        <button id="impersonator_save_preset" class="menu_button flex1" title="Save current settings to preset">
                            <i class="fa-solid fa-save"></i>
                            <span>Save to Preset</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
